
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Biological and Agricultural Engineering Department</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-05-10"><meta name="DC.source" content="Homework2_Guilherme_De_Moura_Araujo.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Biological and Agricultural Engineering Department</h1><!--introduction--><p>Modeling and Analysis of Physical and Biological Processes: EBS 270 Homework No. 2 - Due Date: May 10, 2019 Student: Guilherme De Moura Araujo</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Problem 1 a - Simplified analytical solution</a></li><li><a href="#3">Problem 1b - Surface to produce plot of concentration vs. height and time</a></li><li><a href="#4">Problem 1c - Different times</a></li><li><a href="#5">Problem 1d - Interpretation of results</a></li><li><a href="#6">Problem 1e - Limitations of the model</a></li></ul></div><pre class="codeinput">close <span class="string">all</span>; clear <span class="string">all</span>; clc;
</pre><h2 id="2">Problem 1 a - Simplified analytical solution</h2><p>Assumptions: 1) Peanut butter cup has a cylindrical geometry; 2) Diffusivity is the same in both chocolat and peanut butter layers; 3) There's no migration of lipidis by capilarity; 4) The peanut butter cup is homogenous and isotropic; 5) No vapor pressure escapes to the outside; 6) Concentrations are the same in the interface; 7) Concentration does not change in the radial direction; 8) There's no chemical reaction between peanut buttter and the chocolat.</p><pre class="codeinput">h = 0.018; <span class="comment">% height [m]</span>
hPb = 0.012; <span class="comment">% peanut butter layer thickness [m]</span>
hC = h-hPb; <span class="comment">% chocolate layer thickness [m]</span>
d = 5.5*10^-15; <span class="comment">% diffusivity of the lipid in liquid [m2/s]</span>
co = 0.18; <span class="comment">% initial concentration [%]</span>
dz = h/10; <span class="comment">% [m]</span>
tMax = (365*24*3600*5); <span class="comment">% maximum time (5 years) [s]</span>
dt = tMax/100; <span class="comment">% time step [s]</span>

tgrid = 0:dt:tMax;
zgrid = 0:dz:h;
[z,t] = meshgrid(zgrid , tgrid);
Sum = 0;
infSum = 1E4;

<span class="keyword">for</span> n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t);
    Sum = Sum + (Sin * Cos .* E)/n;
<span class="keyword">end</span>

C = co * (hPb/h - 2*Sum/pi);     <span class="comment">% Simplified analytical solution</span>

plot(t, C)
xlabel(<span class="string">'Time [s]'</span>);
ylabel(<span class="string">'Concentration - [% of lipids in peanut butter]'</span>);
grid;
title (<span class="string">'Concentration vs Time'</span>)
</pre><img vspace="5" hspace="5" src="Homework2_Guilherme_De_Moura_Araujo_01.png" alt=""> <h2 id="3">Problem 1b - Surface to produce plot of concentration vs. height and time</h2><pre class="codeinput">figure()
surf(z, t, C) <span class="comment">% surface plot</span>
colorbar
title (<span class="string">'Lipid Concentration in Peanut Butter Cup'</span>)
xlabel (<span class="string">'Height [m]'</span>);
ylabel (<span class="string">'Time [s]'</span>);
zlabel (<span class="string">'Concentration [%]'</span>);
</pre><img vspace="5" hspace="5" src="Homework2_Guilherme_De_Moura_Araujo_02.png" alt=""> <h2 id="4">Problem 1c - Different times</h2><pre class="codeinput">dz = h/1000; <span class="comment">% [m]</span>
zgrid = 0:dz:h;
[z,t] = meshgrid(zgrid , tgrid);

infSum = 1E2;

t0 = 0;
t1 = 365 * 24 * 3600;
t3 = 3 * 365 * 24 * 3600;
t5 = 5 * 365 * 24 * 3600;
Sum0 = 0;
Sum1 = 0;
Sum3 = 0;
Sum5 = 0;

<span class="keyword">for</span> n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t0);
    Sum0 = Sum0 + (Sin * Cos .* E)/n;
<span class="keyword">end</span>

C0 = co * (hPb/h - 2*Sum0/pi);

<span class="keyword">for</span> n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t1);
    Sum1 = Sum1 + (Sin * Cos .* E)/n;
<span class="keyword">end</span>

C1 = co * (hPb/h - 2*Sum1/pi);

<span class="keyword">for</span> n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t3);
    Sum3 = Sum3 + (Sin * Cos .* E)/n;
<span class="keyword">end</span>

C3 = co * (hPb/h - 2*Sum3/pi);

<span class="keyword">for</span> n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t5);
    Sum5 = Sum5 + (Sin * Cos .* E)/n;
<span class="keyword">end</span>

C5 = co * (hPb/h - 2*Sum5/pi);

<span class="comment">% Plots</span>
x = z(1,:);
figure();
plot(x(1,:), C0(1,:),<span class="string">'g.'</span>, x, C1(1,:), <span class="string">'m.'</span>, x, C3(1,:), <span class="string">'r.'</span>, x, C5(1,:), <span class="string">'b.'</span>)
xlabel(<span class="string">'Position [m]'</span>);
ylabel(<span class="string">'Concentration [% lipids in peanut butter]'</span>);
legend(<span class="string">'t = 0 years'</span>, <span class="string">'t = 1 years'</span>, <span class="string">'t = 3 years'</span>, <span class="string">'t = 5 years'</span>)
grid;
title (<span class="string">'Concentration vs Position'</span>)
</pre><img vspace="5" hspace="5" src="Homework2_Guilherme_De_Moura_Araujo_03.png" alt=""> <h2 id="5">Problem 1d - Interpretation of results</h2><p>Lipid concentration migrates from the peanut butter to the chocolate layer over time. We can notice that for smaller heights (chocolate layer) the concentration is higher for higher times. In addition, there's a descontinuity in the edge between the two layers for t = 0, which suggests that there's no lipid migration for t = 0 (Which is true! Lipids don't start to migrate right after the candy is made). Moreover, we can see that there's practically no differences in the concentrations (at any time) for h &lt; 3 mm or h &gt; 9 mm.</p><h2 id="6">Problem 1e - Limitations of the model</h2><p>Two potential concerns of the model are regarded to the geometry chosen to represent this problem. A peanut butter cup is not actually a cylinder, and the assumption of isotropy is only given considereing the cylindrical geometry of the peanut butter cup. We can overcome these limitations by approaching the problem in a more realistic way, using numerical solutions instead of simplified analytical solutions. This allow us to model the perfect shape of the peanut butter cup, and therefore isotropy is also taken care by the numerical approach. Another concern is the assumption that diffusivity is the same for both layers, which is not necessarily true. We can overcome this issue by creating extra boundary conditions and setting up different coefficiens according to the layer we're analyzing. Something like: D = Dchoc, 0&lt;h&lt;0.006; D = Dpb, h&gt;0.006.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Biological and Agricultural Engineering Department
% Modeling and Analysis of Physical and Biological Processes: EBS 270
% Homework No. 2 - Due Date: May 10, 2019
% Student: Guilherme De Moura Araujo
%%
close all; clear all; clc;

%% Problem 1 a - Simplified analytical solution
% Assumptions:
% 1) Peanut butter cup has a cylindrical geometry;
% 2) Diffusivity is the same in both chocolat and peanut butter layers;
% 3) There's no migration of lipidis by capilarity;
% 4) The peanut butter cup is homogenous and isotropic;
% 5) No vapor pressure escapes to the outside;
% 6) Concentrations are the same in the interface;
% 7) Concentration does not change in the radial direction;
% 8) There's no chemical reaction between peanut buttter and the chocolat.


h = 0.018; % height [m]
hPb = 0.012; % peanut butter layer thickness [m]
hC = h-hPb; % chocolate layer thickness [m]
d = 5.5*10^-15; % diffusivity of the lipid in liquid [m2/s]
co = 0.18; % initial concentration [%]
dz = h/10; % [m]
tMax = (365*24*3600*5); % maximum time (5 years) [s]
dt = tMax/100; % time step [s]

tgrid = 0:dt:tMax;
zgrid = 0:dz:h;
[z,t] = meshgrid(zgrid , tgrid);
Sum = 0;
infSum = 1E4;

for n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t);
    Sum = Sum + (Sin * Cos .* E)/n;
end
 
C = co * (hPb/h - 2*Sum/pi);     % Simplified analytical solution
 
plot(t, C)
xlabel('Time [s]');
ylabel('Concentration - [% of lipids in peanut butter]');
grid;
title ('Concentration vs Time')

%% Problem 1b - Surface to produce plot of concentration vs. height and time
figure()
surf(z, t, C) % surface plot
colorbar
title ('Lipid Concentration in Peanut Butter Cup')
xlabel ('Height [m]');
ylabel ('Time [s]');
zlabel ('Concentration [%]');

%% Problem 1c - Different times
dz = h/1000; % [m]
zgrid = 0:dz:h;
[z,t] = meshgrid(zgrid , tgrid);

infSum = 1E2;

t0 = 0;
t1 = 365 * 24 * 3600;
t3 = 3 * 365 * 24 * 3600;
t5 = 5 * 365 * 24 * 3600;
Sum0 = 0;
Sum1 = 0;
Sum3 = 0;
Sum5 = 0;

for n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t0);
    Sum0 = Sum0 + (Sin * Cos .* E)/n;
end

C0 = co * (hPb/h - 2*Sum0/pi);

for n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t1);
    Sum1 = Sum1 + (Sin * Cos .* E)/n;
end

C1 = co * (hPb/h - 2*Sum1/pi);   

for n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t3);
    Sum3 = Sum3 + (Sin * Cos .* E)/n;
end

C3 = co * (hPb/h - 2*Sum3/pi);   

for n = 1:infSum
    Sin = sin(n * pi * hC/h);
    Cos = cos(n * pi * z/h);
    wn = n * pi/h;
    E = exp( -(wn^2) * d * t5);
    Sum5 = Sum5 + (Sin * Cos .* E)/n;
end

C5 = co * (hPb/h - 2*Sum5/pi); 

% Plots
x = z(1,:);
figure();
plot(x(1,:), C0(1,:),'g.', x, C1(1,:), 'm.', x, C3(1,:), 'r.', x, C5(1,:), 'b.')
xlabel('Position [m]');
ylabel('Concentration [% lipids in peanut butter]');
legend('t = 0 years', 't = 1 years', 't = 3 years', 't = 5 years')
grid;
title ('Concentration vs Position')

%% Problem 1d - Interpretation of results
% Lipid concentration migrates from the peanut butter to the chocolate
% layer over time. We can notice that for smaller heights (chocolate layer)
% the concentration is higher for higher times. In addition, there's a
% descontinuity in the edge between the two layers for t = 0, which
% suggests that there's no lipid migration for t = 0 (Which is true! Lipids 
% don't start to migrate right after the candy is made). Moreover, we can
% see that there's practically no differences in the concentrations (at any
% time) for h < 3 mm or h > 9 mm.

%% Problem 1e - Limitations of the model
% Two potential concerns of the model are regarded to the geometry chosen
% to represent this problem. A peanut butter cup is not actually a
% cylinder, and the assumption of isotropy is only given considereing the
% cylindrical geometry of the peanut butter cup. We can overcome these
% limitations by approaching the problem in a more realistic way, using
% numerical solutions instead of simplified analytical solutions. This
% allow us to model the perfect shape of the peanut butter cup, and
% therefore isotropy is also taken care by the numerical approach.
% Another concern is the assumption that diffusivity is the same for both
% layers, which is not necessarily true. We can overcome this issue by
% creating extra boundary conditions and setting up different
% coefficiens according to the layer we're analyzing. Something like:
% D = Dchoc, 0<h<0.006; D = Dpb, h>0.006.
##### SOURCE END #####
--></body></html>